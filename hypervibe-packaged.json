{
  "AWSTemplateFormatVersion" : "2010-09-09",
  "Transform" : "AWS::Serverless-2016-10-31",
  "Description" : "Hypervibe Bootstrap",
  "Resources" : {
    "ApiGatewayApi" : {
      "Type" : "AWS::Serverless::Api",
      "Properties" : {
        "DefinitionBody" : {
          "swagger" : 2.0,
          "basePath" : "/dev",
          "info" : {
            "title" : "Hypervibe"
          },
          "schemes" : [ "https" ],
          "paths" : {
            "/" : {
              "x-amazon-apigateway-any-integration" : {
                "produces" : [ "application/json" ],
                "responses" : {
                  "200" : {
                    "description" : "200 response",
                    "schema" : {
                      "$ref" : "#/definitions/Empty"
                    }
                  }
                }
              }
            },
            "/read" : {
              "get" : {
                "x-amazon-apigateway-integration" : {
                  "responses" : {
                    "default" : {
                      "statusCode" : 200
                    }
                  },
                  "uri" : {
                    "Fn::Sub" : "arn:aws:apigateway:eu-west-1:lambda:path/2015-03-31/functions/${Read.Arn}/invocations"
                  },
                  "passthroughBehavior" : "when_no_match",
                  "httpMethod" : "POST",
                  "type" : "aws_proxy"
                }
              }
            }
          },
          "definitions" : {
            "Empty" : {
              "type" : "object",
              "title" : "Empty Schema"
            }
          }
        },
        "StageName" : "dev"
      }
    },
    "Read" : {
      "Type" : "AWS::Serverless::Function",
      "Properties" : {
        "Handler" : "hypervibe.core.lambda::handleRequest",
        "Runtime" : "java8",
        "Policies" : {
          "Statement" : [ {
            "Effect" : "Allow",
            "Action" : [ "logs:*", "cloudwatch:*", "dynamodb:*" ],
            "Resource" : "*"
          } ]
        },
        "MemorySize" : 512,
        "Timeout" : 10,
        "CodeUri" : "target/hypervibe-0.1.0-SNAPSHOT-standalone.jar",
        "Events" : {
          "PostConfig" : {
            "Type" : "Api",
            "Properties" : {
              "Path" : "/read",
              "RestApiId" : "ApiGatewayApi",
              "Method" : "GET"
            }
          }
        }
      }
    }
  }
}